<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 1.11.1 from src/site/markdown/exporting-objects.md at 2024-05-19
 | Rendered using Apache Maven Fluido Skin 1.12.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.11.1" />
    <title>dbus-java &#x2013; Exporting Objects</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.12.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-1.12.0.min.js"></script>
  </head>
  <body>
    <div class="container-fluid container-fluid-top">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h1>dbus-java</h1>
</div>
</div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2024-05-19</li>
      <li id="projectVersion" class="pull-right">Version: 5.1.0-SNAPSHOT</li>
        <li class="pull-right"><span class="divider">|</span>
<a href="https://search.maven.org/search?q=g:com.github.hypfvieh%20dbus-java" class="externalLink" title="Maven Central">Maven Central</a></li>
        <li class="pull-right"><span class="divider">|</span>
<a href="https://www.github.com/hypfvieh/dbus-java/wiki" class="externalLink" title="GitHub Wiki">GitHub Wiki</a></li>
        <li class="pull-right"><a href="https://www.github.com/hypfvieh/dbus-java" class="externalLink" title="GitHub Repository">GitHub Repository</a></li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Overview</li>
    <li><a href="index.html" title="Home"><span class="none"></span>Home</a></li>
    <li><a href="quick-start.html" title="Quickstart"><span class="none"></span>Quickstart</a></li>
    <li><a href="code-generation.html" title="Code Generation"><span class="none"></span>Code Generation</a></li>
    <li class="active"><a><span class="none"></span>Exporting Objects</a></li>
    <li><a href="remote-objects.html" title="Calling Remote Objects"><span class="none"></span>Calling Remote Objects</a></li>
    <li><a href="properties.html" title="Properties"><span class="none"></span>Properties</a></li>
    <li><a href="variant-handling.html" title="Variant"><span class="none"></span>Variant</a></li>
    <li><a href="howto.html" title="Howto..."><span class="none"></span>Howto...</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
   <li class="nav-header">Modules</li>
    <li><a href="dbus-java-core/index.html" title="dbus-java-core"><span class="none"></span>dbus-java-core</a></li>
    <li><a href="dbus-java-osgi/index.html" title="dbus-java-osgi"><span class="none"></span>dbus-java-osgi</a></li>
    <li><a href="dbus-java-utils/index.html" title="dbus-java-utils"><span class="none"></span>dbus-java-utils</a></li>
    <li><a href="dbus-java-transport-jnr-unixsocket/index.html" title="dbus-java-transport-jnr-unixsocket"><span class="none"></span>dbus-java-transport-jnr-unixsocket</a></li>
    <li><a href="dbus-java-transport-junixsocket/index.html" title="dbus-java-transport-junixsocket"><span class="none"></span>dbus-java-transport-junixsocket</a></li>
    <li><a href="dbus-java-transport-native-unixsocket/index.html" title="dbus-java-transport-native-unixsocket"><span class="none"></span>dbus-java-transport-native-unixsocket</a></li>
    <li><a href="dbus-java-transport-tcp/index.html" title="dbus-java-transport-tcp"><span class="none"></span>dbus-java-transport-tcp</a></li>
    <li><a href="dbus-java-bom/index.html" title="dbus-java-bom"><span class="none"></span>dbus-java-bom</a></li>
    <li><a href="dbus-java-tests/index.html" title="dbus-java-tests"><span class="none"></span>dbus-java-tests</a></li>
    <li><a href="dbus-java-examples/index.html" title="dbus-java-examples"><span class="none"></span>dbus-java-examples</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >
<h1>Exporting Objects</h1>
<p><i><a class="externalLink" href="https://github.com/hypfvieh/dbus-java/tree/master/dbus-java-examples/src/main/java/com/github/hypfvieh/dbus/examples/export">Full Source</a></i></p>
<p>In order for other programs to call a method, you must first export the object
onto the bus in order for other programs to see it.  The object that is exported
must implement an interface which extends <code>DBusInterface</code>.</p>
<p>Here's a sample interface:</p>

<div class="source"><pre class="prettyprint"><code class="language-java">package com.github.hypfvieh.dbus.examples.export;

import org.freedesktop.dbus.interfaces.DBusInterface;

public interface ISampleExport extends DBusInterface {
    int add(int _a, int _b);

    void terminateApp();
}
</code></pre></div>
<p>In order for other applications to call this interface, we need to create an
object that implements this interface and export it onto the bus.  Here's the
full code that does that:</p>

<div class="source"><pre class="prettyprint"><code class="language-java">package com.github.hypfvieh.dbus.examples.export;

import org.freedesktop.dbus.connections.impl.DBusConnection;
import org.freedesktop.dbus.connections.impl.DBusConnectionBuilder;
import org.freedesktop.dbus.exceptions.DBusException;

import java.util.concurrent.CountDownLatch;

public class ExportExample implements ISampleExport {

    private DBusConnection dbusConn;
    private CountDownLatch waitClose;

    ExportExample() throws DBusException, InterruptedException {
        waitClose = new CountDownLatch(1);
        // Get a connection to the session bus so we can request a bus name
        dbusConn = DBusConnectionBuilder.forSessionBus().build();
        // Request a unique bus name
        dbusConn.requestBusName(&quot;test.dbusjava.export&quot;);
        // Export this object onto the bus using the path '/'
        dbusConn.exportObject(getObjectPath(), this);
        // this will cause the countdown latch to wait until terminateApp() was called
        // you probably want to do something more useful
        waitClose.await();
        System.out.println(&quot;bye bye&quot;);
    }

    @Override
    public int add(int _a, int _b) {
        return _a + _b;
    }

    @Override
    public void terminateApp() {
        waitClose.countDown();
    }

    @Override
    public boolean isRemote() {
        /* Whenever you are implementing an object, always return false */
        return false;
    }

    @Override
    public String getObjectPath() {
        /*
         * This is not strictly needed; 
         * it is a convenience method for housekeeping on your application side if you will
         * be exporting and unexporting many times
         */
        return &quot;/&quot;;
    }

    public static void main(String[] _args) throws Exception {
        new ExportExample();
    }

}
</code></pre></div>
<p>If you compile and run this program, you will be able to do three things at this
point: view the introspection data get the result of an addition and terminate our application by
calling <code>terminateApp()</code>.</p>
<p>If we introspect our application like the following, we can see the
<i>automatically</i> generated introspection XML document.  This means that we can
define an entire interface without touching XML at all.</p>

<div class="source"><pre class="prettyprint"><code>$ dbus-send --print-reply=literal --type=method_call --dest=test.dbusjava.export / org.freedesktop.DBus.Introspectable.Introspect

&lt;!DOCTYPE node PUBLIC &quot;-//freedesktop//DTD D-BUS Object Introspection 
 1.0//EN&quot; &quot;http://www.freedesktop.org/standards/dbus/1.0/introspect.dtd&quot;&gt;
 &lt;node name=&quot;/&quot;&gt;
  &lt;interface name=&quot;com.github.hypfvieh.dbus.examples.export.ISampleExport&quot;&gt;
   &lt;method name=&quot;add&quot; &gt;
    &lt;arg type=&quot;i&quot; direction=&quot;in&quot;/&gt;
    &lt;arg type=&quot;i&quot; direction=&quot;in&quot;/&gt;
    &lt;arg type=&quot;i&quot; direction=&quot;out&quot;/&gt;
   &lt;/method&gt;
   &lt;method name=&quot;terminateApp&quot; &gt;
   &lt;/method&gt;
  &lt;/interface&gt;
  &lt;interface name=&quot;org.freedesktop.DBus.Introspectable&quot;&gt;
   &lt;method name=&quot;Introspect&quot; &gt;
    &lt;arg type=&quot;s&quot; direction=&quot;out&quot;/&gt;
   &lt;/method&gt;
  &lt;/interface&gt;
  &lt;interface name=&quot;org.freedesktop.DBus.Peer&quot;&gt;
   &lt;method name=&quot;Ping&quot; &gt;
   &lt;/method&gt;
   &lt;method name=&quot;GetMachineId&quot; &gt;
    &lt;arg type=&quot;s&quot; direction=&quot;out&quot;/&gt;
   &lt;/method&gt;
  &lt;/interface&gt;
 &lt;/node&gt;
</code></pre></div>
<p>Next, we can go call the remote method using dbus-send and get the result of
the addition back:</p>

<div class="source"><pre class="prettyprint"><code>$ dbus-send --print-reply=literal --type=method_call --dest=test.dbusjava.export / com.foo.IntInterface.add int32:5 int32:7
   int32 12
</code></pre></div>
<p>Or we can use the <code>terminateApp()</code> method to stop our application:</p>

<div class="source"><pre class="prettyprint"><code>$ dbus-send --print-reply=literal --type=method_call --dest=test.dbusjava.export / com.foo.IntInterface.terminateApp
</code></pre></div>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>©      2024
</p>
        </div>
      </div>
    </footer>
<script>
  if(anchors) {
    anchors.add();
  }
</script>
  </body>
</html>
